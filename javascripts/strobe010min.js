(function(a){var b={};window.Strobe=b,b.isNativeApp||(b.isNativeApp=window.DeviceInfo&&DeviceInfo.uuid!==undefined),b.useHttps||(b.useHttps=!1),b.urlFor=function(a){var c=a.replace(/^\//,"");return b.isNativeApp?c:"/_strobe/proxy/"+c},b.ajax=function(c,d){return typeof c=="object"&&(d=c,c=undefined),d||(d={}),d.headers||(d.headers={}),c||(c=d.url),c=c.replace(/^https?:\/\//,function(a){return a==="https://"&&(d.headers["X-Strobe-Proxy-Protocol"]="https"),""}),d.url=b.urlFor(c),a.ajax(d)},b.popup=function(b,c,d){d=a.extend({width:600,height:680,scrollbars:!0,location:!0,toolbar:!1,menubar:!1,status:!1},d);var e,f,g=typeof window.screenX!="undefined"?window.screenX:window.screenLeft,h=typeof window.screenY!="undefined"?window.screenY:window.screenTop,i=typeof window.outerWidth!="undefined"?window.outerWidth:document.documentElement.clientWidth,j=typeof window.outerHeight!="undefined"?window.outerHeight:document.documentElement.clientHeight-22,k=parseInt((g<0?window.screen.width+g:g)+(i-d.width)/2,10),l=parseInt(h+(j-d.height)/2.5,10);return f=["width="+d.width,"height="+d.height,"left="+(d.left!=="undefined"?k:d.left),"top="+(d.top!=="undefined"?l:d.top),"scrollbars="+(d.scrollbars?"1":"0"),"location="+(d.location?"1":"0"),"toolbar="+(d.toolbar?"1":"0"),"menubar="+(d.menubar?"1":"0"),"status="+(d.status?"1":"0")],e=window.open(b,c,f.join(",")),e.focus(),e},b.getCookie=function(a,b){b||(b=document.cookie);var c="; "+b+";",d=c.indexOf("; "+a+"=");return d>-1?c.slice(d+=3+a.length,c.indexOf(";",d)):undefined},b.deleteCookie=function(a,b,c){document.cookie=""+a+"="+(b?";path="+b:"")+(c?";domain="+c:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"},b.applicationUrl=function(){if(!Settings.applicationUrl)throw"Application url was not loaded";var a=b.useHttps?"https://":"http://";return a+Settings.applicationUrl};var c,d,e;b._reset=function(){c=!1,d=[],e=null},b._reset(),b._when=function(){if(!e){var b=a.map(d,function(a){return a()});e=a.when.apply(this,b)}return e},b._addDependency=function(b){d.push(function(){return a.Deferred(function(a){b(a)})})},b.run=function(a,e){var f=function(){a.apply(e)};c||d.length===0?f():b._when().then(f).then(function(){c=!0})},b.hasLoaded=function(){return c};var f="0.1.0"})(jQuery),function(a,b,c){var d=a.encodeURIComponent,e=c.Social=function(a){var b=function(){},d;return b.prototype=c.Social[a].prototype,d=new b,d.service=a,d},f=e.Twitter=e.twitter=function(){},g=e.Facebook=e.facebook=function(){},h=f.prototype,i=g.prototype;h.tweet=function(a,b){c.run(function(){b=b||{},b.type="post",b.data={status:a},this.ajax("1/statuses/update.json",b)},this)},h.ajax=function(a,c){return typeof a=="object"&&(c=a,a=undefined),c||(c={}),a||(a=c.url),c.url=this.urlFor(a),b.ajax(c)},h.urlFor=function(a){var b="/_strobe/social/twitter/";return c.isNativeApp&&(b=c.applicationUrl()+b),b+a.replace(/^\//,"")},h.oauthCallback=function(){var b=this.urlFor("/callback");return c.isNativeApp?b:a.location.protocol+"//"+a.location.host+b},h.login=function(e,f){c.run(function(){e||(e={}),e.oauthCallback||(e.oauthCallback=this.oauthCallback()),e.interval||(e.interval=100),e.type||(e.type="popup"),f=f===undefined?!0:!1;var g,h,i,j=this,k=e.error,l=e.success;i=this.urlFor("/authentication?oauth_callback="),i+=d(e.oauthCallback),b.ajax(i,{success:function(b){var d=b.authentication;if(d.status==="unauthenticated")if(f){c.isNativeApp&&(e.type="popup");var i=d.authentication_uri;if(e.type==="popup")c.isNativeApp?(a.plugins.childBrowser.onLocationChange=function(b){b=b.replace(/^https?:\/\/|\/$/g,"");var d=c.applicationUrl().replace(/^https?:\/\/|\/$/g,"");b==d&&(a.plugins.childBrowser.close(),j.login(e,!1))},a.plugins.childBrowser.showWebPage(i,{showLocationBar:!1})):(h=c.popup(i,"twitter_authentication"),g=a.setInterval(function(){h.closed&&(a.clearInterval(g),j.login(e,!1))},e.interval));else{a.location=i;return}}else k&&k();else l&&l()},error:e.error})},this)},h.logout=function(a){c.run(function(){a||(a={}),b.ajax({type:"DELETE",url:this.urlFor("/authentication"),success:a.success,error:a.error,complete:a.complete})},this)},i.redirectUri=function(){var b="/_strobe/social/facebook/callback";return c.isNativeApp?b=c.applicationUrl()+b:b=a.location.protocol+"//"+a.location.host+b,b},i.login=function(b){c.run(function(){b||(b={}),b.type||(b.type="popup"),b.interval||(b.interval=100),b.scope||(b.scope=""),b.redirectUri||(b.redirectUri=this.redirectUri());var e,f,g;g="https://www.facebook.com/dialog/oauth?response_type=token",g+="&scope="+d(b.scope),g+="&client_id="+d(b.clientId),g+="&redirect_uri="+d(b.redirectUri),c.isNativeApp&&(b.type="popup");switch(b.type){case"redirect":a.location=g;break;case"popup":var h=this;c.isNativeApp?(a.plugins.childBrowser.onLocationChange=function(d){d=d.replace(/^https?:\/\/|\/$/g,"");var e=c.applicationUrl().replace(/^https?:\/\/|\/$/g,"");d===e&&(a.plugins.childBrowser.close(),setTimeout(function(){h.status({callback:b.callback})},100))},a.plugins.childBrowser.showWebPage(g,{showLocationBar:!1})):(g+="&display=popup",f=c.popup(g,"facebook_authentication",{width:627,height:326}),e=a.setInterval(function(){f.closed&&(a.clearInterval(e),h.status({callback:b.callback}))},b.interval));break;default:}},this)},i.logout=function(a){c.run(function(){a||(a={});var c=this.rawUrlFor("/_strobe/social/facebook.json");b.ajax({url:c,dataType:"json",type:"DELETE",success:function(b,c,d){var f={status:b.status};e.facebook.ACCESS_TOKEN=null,a.callback(f)},error:function(){e.facebook.ACCESS_TOKEN=null,a.callback({status:"UNAUTHORIZED"})}})},this)},i.status=function(a){c.run(function(){a||(a={});var c=this.rawUrlFor("/_strobe/social/facebook/status.json");b.ajax({url:c,dataType:"json",success:function(b,c,d){var f={status:b.status},g=b.access_token;g&&(e.facebook.ACCESS_TOKEN=g,f.accessToken=g),a.callback(f)},error:function(){a.callback({status:"UNAUTHORIZED"})}})},this)},i.rawUrlFor=function(a){return c.isNativeApp&&(a=c.applicationUrl()+"/"+a.replace(/^\//,"")),a},i.urlFor=function(a){var b="/_strobe/proxy/graph.facebook.com/";return a=b+a.replace(/^\//,""),this.rawUrlFor(a)},i.send=function(a,c){c||(c={}),c.headers||(c.headers={}),c.accessToken||(c.accessToken=e.facebook.ACCESS_TOKEN);if(!c.accessToken&&!e.facebook.hasOwnProperty("ACCESS_TOKEN")){var f=this;return this.status({callback:function(b){f.send(a,c)}})}return c.url=this.urlFor(a),e.facebook.ACCESS_TOKEN&&(c.headers["X-Strobe-Proxy-Protocol"]="https",c.url+=c.url.indexOf("?")===-1?"?access_token=":"&access_token=",c.url+=d(e.facebook.ACCESS_TOKEN)),b.ajax(c)}}(this,jQuery,Strobe)